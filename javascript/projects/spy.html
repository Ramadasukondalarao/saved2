<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UPSC Practice App</title>
    <style>
        .page { display: none; padding: 20px; }
        .active-page { display: block; }
        .category-btn { margin: 10px; padding: 15px; width: 200px; }
        .question { margin-bottom: 20px; }
        .option { margin: 5px; padding: 10px; border: 1px solid #ccc; cursor: pointer; }
        .selected { background-color: #e0e0e0; }
        .navigation { margin-top: 20px; }
    </style>
</head>
<body>
    <!-- Page 1: Login -->
    <div id="page1" class="page active-page">
        <h2>Login</h2>
        <form id="loginForm">
            <input type="text" placeholder="Name" required>
            <input type="email" placeholder="Email" required>
            <button type="submit">Login</button>
        </form>
    </div>

    <!-- Page 2: Categories -->
    <div id="page2" class="page">
        <h2>Select Subject</h2>
        <div id="categories"></div>
    </div>

    <!-- Page 3: Questions -->
    <div id="page3" class="page">
        <h2 id="subjectTitle"></h2>
        <div id="questionsContainer"></div>
        <div class="navigation">
            <button id="prevBtn">Previous</button>
            <button id="nextBtn">Next</button>
        </div>
    </div>

    <!-- Page 4: Results -->
    <div id="page4" class="page">
        <h2>Results</h2>
        <div id="results"></div>
    </div>

    <script>
        // Page navigation
        function showPage(pageId) {
            document.querySelectorAll('.page').forEach(page => {
                page.classList.remove('active-page');
            });
            document.getElementById(pageId).classList.add('active-page');
        }

        // Page 1: Login
        document.getElementById('loginForm').addEventListener('submit', (e) => {
            e.preventDefault();
            const user = {
                name: e.target[0].value,
                email: e.target[1].value
            };
            localStorage.setItem('user', JSON.stringify(user));
            initializeCategories();
            showPage('page2');
        });

        // Page 2: Categories
        const categories = ['History', 'Geography', 'Polity', 'Economy', 'Science', 'Current Affairs'];
        const questions = {};
        
        function initializeCategories() {
            const container = document.getElementById('categories');
            categories.forEach(subject => {
                const btn = document.createElement('button');
                btn.className = 'category-btn';
                btn.textContent = subject;
                btn.onclick = () => loadQuestions(subject);
                container.appendChild(btn);
                
                // Generate sample questions
                questions[subject] = Array.from({length: 20}, (_, i) => ({
                    question: `${subject} Question ${i+1}`,
                    options: ['Option 1', 'Option 2', 'Option 3', 'Option 4'],
                    correct: Math.floor(Math.random() * 4)
                }));
            });
        }
        // Page 3: Questions
        let currentSubject, currentQuestionIndex = 0, userAnswers = [];
        
        function loadQuestions(subject) {
            currentSubject = subject;
            currentQuestionIndex = 0;
            userAnswers = [];
            document.getElementById('subjectTitle').textContent = subject;
            showPage('page3');
            showQuestion();
        }

        function showQuestion() {
            const container = document.getElementById('questionsContainer');
            container.innerHTML = '';
            
            const question = questions[currentSubject][currentQuestionIndex];
            const div = document.createElement('div');
            div.className = 'question';
            
            div.innerHTML = `
                <h3>${question.question}</h3>
                ${question.options.map((opt, i) => `
                    <div class="option" onclick="selectAnswer(${i})">${opt}</div>
                `).join('')}
            `;
            
            container.appendChild(div);
            updateNavigation();
        }

        window.selectAnswer = (index) => {
            document.querySelectorAll('.option').forEach(opt => opt.classList.remove('selected'));
            event.target.classList.add('selected');
            userAnswers[currentQuestionIndex] = index;
        }

        function updateNavigation() {
            document.getElementById('prevBtn').disabled = currentQuestionIndex === 0;
            document.getElementById('nextBtn').disabled = currentQuestionIndex === 19;
        }

        document.getElementById('prevBtn').addEventListener('click', () => {
            if (currentQuestionIndex > 0) {
                currentQuestionIndex--;
                showQuestion();
            }
        });

        document.getElementById('nextBtn').addEventListener('click', () => {
            if (currentQuestionIndex < 19) {
                currentQuestionIndex++;
                showQuestion();
            } else {
                showResults();
            }
        });

        // Page 4: Results
        function showResults() {
            const score = questions[currentSubject].reduce((acc, q, i) => 
                acc + (userAnswers[i] === q.correct ? 1 : 0), 0);
            
            const user = JSON.parse(localStorage.getItem('user'));
            const resultData = { ...user, subject: currentSubject, score };
            
            localStorage.setItem('scoreStorage', JSON.stringify(resultData));
            
            document.getElementById('results').innerHTML = `
                <p>Name: ${user.name}</p>
                <p>Email: ${user.email}</p>
                <p>Subject: ${currentSubject}</p>
                <h3>Score: ${score}/20</h3>
                <p>Thank you for writing this exam!</p>
            `;
            
            showPage('page4');
        }
    </script>
</body>
</html>